<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="704px" preserveAspectRatio="none" style="width:825px;height:704px;background:#F2EEE6;" version="1.1" viewBox="0 0 825 704" width="825px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="18" lengthAdjust="spacing" textLength="164" x="332" y="29.4023">Login to the Riiiver</text><rect fill="#FFFFFF" height="508.166" style="stroke:#222222;stroke-width:1.0;" width="10" x="482.5" y="180.3086"/><rect fill="#F3F0F0" height="420.5449" style="stroke:#000000;stroke-width:2.0;" width="809" x="9" y="259.9297"/><rect fill="#F3F0F0" height="61.9316" style="stroke:#000000;stroke-width:2.0;" width="363" x="445" y="551.9668"/><rect fill="#F3F0F0" height="59.5762" style="stroke:none;stroke-width:1.0;" width="809" x="9" y="620.8984"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="39" x2="39" y1="119.6875" y2="697.4746"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="141" x2="141" y1="119.6875" y2="697.4746"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="487" x2="487" y1="119.6875" y2="697.4746"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="596.5" x2="596.5" y1="119.6875" y2="697.4746"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="765" x2="765" y1="119.6875" y2="697.4746"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="14" lengthAdjust="spacing" textLength="31" x="21" y="116.7344">User</text><ellipse cx="39.5" cy="50.1992" fill="#EEEEEE" rx="8" ry="8" style="stroke:#000000;stroke-width:2.0;"/><path d="M39.5,58.1992 L39.5,85.1992 M26.5,66.1992 L52.5,66.1992 M39.5,85.1992 L26.5,100.1992 M39.5,85.1992 L52.5,100.1992 " fill="none" style="stroke:#000000;stroke-width:2.0;"/><rect fill="#FFFFFF" height="34.0215" style="stroke:#111111;stroke-width:1.5;" width="87" x="98" y="84.666"/><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="73" x="105" y="108.1016">YourApp</text><rect fill="#FFFFFF" height="54.043" style="stroke:#111111;stroke-width:1.5;" width="65" x="455" y="64.6445"/><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="51" x="462" y="88.0801">Riiiver</text><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="33" x="471" y="108.1016">SDK</text><rect fill="#FFFFFF" height="54.043" style="stroke:#111111;stroke-width:1.5;" width="126" x="533.5" y="64.6445"/><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="45" x="574" y="88.0801">Safari</text><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="112" x="540.5" y="108.1016">(Ext. Browser)</text><rect fill="#FFFFFF" height="54.043" style="stroke:#111111;stroke-width:1.5;" width="65" x="733" y="64.6445"/><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="51" x="740" y="88.0801">Riiiver</text><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="49" x="741" y="108.1016">Cloud</text><rect fill="#FFFFFF" height="508.166" style="stroke:#222222;stroke-width:1.0;" width="10" x="482.5" y="180.3086"/><polygon fill="#444444" points="129.5,146.998,139.5,150.998,129.5,154.998,133.5,150.998" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="39.5" x2="135.5" y1="150.998" y2="150.998"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="78" x="46.5" y="146.2559">execute App</text><polygon fill="#444444" points="470.5,176.3086,480.5,180.3086,470.5,184.3086,474.5,180.3086" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="141.5" x2="476.5" y1="180.3086" y2="180.3086"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="298" x="148.5" y="175.5664">ERAuth.getInstance().initialize(Context context)</text><polygon fill="#444444" points="470.5,216.2744,480.5,220.2744,470.5,224.2744,474.5,220.2744" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="141.5" x2="476.5" y1="220.2744" y2="220.2744"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="203" x="148.5" y="215.5322">ERAuth.getInstance().isLoggedIn</text><path d="M29,193.3086 L29,233.3086 L136,233.3086 L136,203.3086 L126,193.3086 L29,193.3086 " fill="#F9B5AD" style="stroke:#A80036;stroke-width:1.0;"/><path d="M126,193.3086 L126,203.3086 L136,203.3086 L126,193.3086 " fill="#F9B5AD" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="79" x="35" y="210.877">Check if you</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="86" x="35" y="226.1875">are logged in.</text><polygon fill="#444444" points="152.5,240.9297,142.5,244.9297,152.5,248.9297,148.5,244.9297" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="146.5" x2="481.5" y1="244.9297" y2="244.9297"/><path d="M9,259.9297 L71,259.9297 L71,266.9297 L61,276.9297 L9,276.9297 L9,259.9297 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="420.5449" style="stroke:#000000;stroke-width:2.0;" width="809" x="9" y="259.9297"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="24" y="273.498">alt</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="392" x="86" y="272.5645">[ERSDK: ERAuth.getInstance().isLoggedIn == false (not logged in yet)]</text><polygon fill="#444444" points="470.5,340.4824,480.5,344.4824,470.5,348.4824,474.5,344.4824" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="141.5" x2="476.5" y1="344.4824" y2="344.4824"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="242" x="148.5" y="293.8086">ERAuth.sharedInstance.startWebLogin(</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="147" x="180.5" y="309.1191">List&lt;String&gt; deviceIds,</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="220" x="180.5" y="324.4297">IERAuthWebLoginCallback callback</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="4" x="148.5" y="339.7402">)</text><polygon fill="#444444" points="584.5,369.793,594.5,373.793,584.5,377.793,588.5,373.793" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="492.5" x2="590.5" y1="373.793" y2="373.793"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="80" x="499.5" y="369.0508">Login screen</text><polygon fill="#444444" points="584.5,399.1035,594.5,403.1035,584.5,407.1035,588.5,403.1035" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="39.5" x2="590.5" y1="403.1035" y2="403.1035"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="108" x="46.5" y="398.3613">Login Operations</text><polygon fill="#444444" points="607.5,428.4141,597.5,432.4141,607.5,436.4141,603.5,432.4141" style="stroke:#444444;stroke-width:1.0;"/><polygon fill="#444444" points="753.5,428.4141,763.5,432.4141,753.5,436.4141,757.5,432.4141" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="601.5" x2="759.5" y1="432.4141" y2="432.4141"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="145" x="613.5" y="427.6719">Authentication Process</text><polygon fill="#444444" points="152.5,457.7246,142.5,461.7246,152.5,465.7246,148.5,461.7246" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="146.5" x2="595.5" y1="461.7246" y2="461.7246"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="217" x="158.5" y="456.9824">Launching apps with URL schemas</text><polygon fill="#444444" points="470.5,532.9668,480.5,536.9668,470.5,540.9668,474.5,536.9668" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="141.5" x2="476.5" y1="536.9668" y2="536.9668"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="317" x="148.5" y="486.293">ERAuth.sharedInstance.challengeAuthByWebLogin(</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="82" x="180.5" y="501.6035">Intent intent,</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="221" x="180.5" y="516.9141">IERAuthChallengeCallback callback</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="4" x="148.5" y="532.2246">)</text><path d="M19,487.0352 L19,527.0352 L136,527.0352 L136,497.0352 L126,487.0352 L19,487.0352 " fill="#F9B5AD" style="stroke:#A80036;stroke-width:1.0;"/><path d="M126,487.0352 L126,497.0352 L136,497.0352 L126,487.0352 " fill="#F9B5AD" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="68" x="25" y="504.6035">Attempt to</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="96" x="25" y="519.9141">save the token.</text><path d="M445,551.9668 L507,551.9668 L507,558.9668 L497,568.9668 L445,568.9668 L445,551.9668 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="61.9316" style="stroke:#000000;stroke-width:2.0;" width="363" x="445" y="551.9668"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="460" y="565.5352">alt</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="122" x="522" y="564.6016">[callbackのonSuccess]</text><polygon fill="#444444" points="503.5,601.8984,493.5,605.8984,503.5,609.8984,499.5,605.8984" style="stroke:#444444;stroke-width:1.0;"/><polygon fill="#444444" points="753.5,601.8984,763.5,605.8984,753.5,609.8984,757.5,605.8984" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="497.5" x2="759.5" y1="605.8984" y2="605.8984"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="109" x="509.5" y="585.8457">Login completed.</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="165" x="509.5" y="601.1563">Token saved successfully.</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="9" x2="818" y1="621.8984" y2="621.8984"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="391" x="14" y="632.5332">[ERSDK: ERAuth.getInstance().isLoggedIn == true (Already logged in)]</text><polygon fill="#444444" points="503.5,668.4746,493.5,672.4746,503.5,676.4746,499.5,672.4746" style="stroke:#444444;stroke-width:1.0;"/><polygon fill="#444444" points="753.5,668.4746,763.5,672.4746,753.5,676.4746,757.5,672.4746" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="497.5" x2="759.5" y1="672.4746" y2="672.4746"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="66" x="509.5" y="652.4219">Logged in.</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="150" x="509.5" y="667.7324">Already obtained token.</text><!--MD5=[3deaf466085e3db0e7d5212381bb9776]
@startuml
title Login to the Riiiver
hide footbox

skinparam DefaultFontName "Noto Sans JP, Helvetica, Arial, Liberation Sans"
skinparam BackgroundColor #F2EEE6
skinparam Shadowing false
skinparam NoteBackgroundColor #F9B5AD
skinparam NodeBorderColor #F26767

skinparam sequence {
ArrowColor #444444
ActorBorderColor Black
LifeLineBorderColor #222222
LifeLineBackgroundColor White
BoxBorderColor #FFFFFF
BoxBackgroundColor #F2fEf6
GroupBackgroundColor #FFFFFF
GroupBodyBackgroundColor #F3F0F0

ParticipantBorderColor #111111
ParticipantBackgroundColor White
ParticipantFontSize 17
ParticipantFontColor #111111
BoundaryBorderColor Gray
ActorBackgroundColor #eeeeee
ActorFontColor Black

}

actor User
participant YourApp as App
participant "Riiiver\nSDK" as ERSDK
participant "Safari\n(Ext. Browser)" as Safari
participant "Riiiver\nCloud" as Riiiver

User -> App: execute App

App -> ERSDK: ERAuth.getInstance().initialize(Context context)
activate ERSDK

App -> ERSDK: ERAuth.getInstance().isLoggedIn
note left: Check if you\nare logged in.
ERSDK - -> App: 

alt ERSDK: ERAuth.getInstance().isLoggedIn == false (not logged in yet)
    App -> ERSDK: ERAuth.sharedInstance.startWebLogin(\n\tList<String> deviceIds,\n\tIERAuthWebLoginCallback callback\n)
    ERSDK -> Safari: Login screen
    User -> Safari: Login Operations
    Safari <-> Riiiver: Authentication Process
    Safari -> App: Launching apps with URL schemas
    App -> ERSDK: ERAuth.sharedInstance.challengeAuthByWebLogin(\n\tIntent intent,\n\tIERAuthChallengeCallback callback\n)
    note left: Attempt to\nsave the token.
    alt callbackのonSuccess
        ERSDK <- - -> Riiiver: Login completed.\nToken saved successfully. 
    end
    
else ERSDK: ERAuth.getInstance().isLoggedIn == true (Already logged in)
    ERSDK <- - -> Riiiver: Logged in.\nAlready obtained token.
end





@enduml

PlantUML version 1.2021.7(Sun May 23 21:40:07 JST 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: ja
Country: JP
--></g></svg>