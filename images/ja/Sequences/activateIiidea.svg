<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1165px" preserveAspectRatio="none" style="width:763px;height:1165px;background:#F2EEE6;" version="1.1" viewBox="0 0 763 1165" width="763px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="18" lengthAdjust="spacing" textLength="265" x="248.5" y="29.4023">iiideaをON(アクティベート)する</text><rect fill="#FFFFFF" height="114.8867" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="220.5" y="129.6875"/><line style="stroke:#222222;stroke-width:1.0;" x1="220.5" x2="220.5" y1="129.6875" y2="244.5742"/><line style="stroke:#222222;stroke-width:1.0;" x1="230.5" x2="230.5" y1="129.6875" y2="244.5742"/><line style="stroke:#222222;stroke-width:1.0;" x1="220.5" x2="230.5" y1="129.6875" y2="129.6875"/><rect fill="#FFFFFF" height="864.0664" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="220.5" y="285.5293"/><line style="stroke:#222222;stroke-width:1.0;" x1="220.5" x2="220.5" y1="285.5293" y2="1149.5957"/><line style="stroke:#222222;stroke-width:1.0;" x1="230.5" x2="230.5" y1="285.5293" y2="1149.5957"/><line style="stroke:#222222;stroke-width:1.0;" x1="220.5" x2="230.5" y1="1149.5957" y2="1149.5957"/><rect fill="#F3F0F0" height="233.3711" style="stroke:#000000;stroke-width:2.0;" width="684" x="10" y="908.2246"/><rect fill="#F3F0F0" height="186.75" style="stroke:none;stroke-width:1.0;" width="684" x="10" y="954.8457"/><line style="stroke:#222222;stroke-width:1.0;" x1="38" x2="38" y1="119.6875" y2="129.6875"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="38" x2="38" y1="129.6875" y2="170.6426"/><line style="stroke:#222222;stroke-width:1.0;" x1="38" x2="38" y1="170.6426" y2="244.5742"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="38" x2="38" y1="244.5742" y2="285.5293"/><line style="stroke:#222222;stroke-width:1.0;" x1="38" x2="38" y1="285.5293" y2="1158.5957"/><line style="stroke:#222222;stroke-width:1.0;" x1="225" x2="225" y1="119.6875" y2="129.6875"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="225" x2="225" y1="129.6875" y2="170.6426"/><line style="stroke:#222222;stroke-width:1.0;" x1="225" x2="225" y1="170.6426" y2="244.5742"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="225" x2="225" y1="244.5742" y2="285.5293"/><line style="stroke:#222222;stroke-width:1.0;" x1="225" x2="225" y1="285.5293" y2="1158.5957"/><line style="stroke:#222222;stroke-width:1.0;" x1="511" x2="511" y1="119.6875" y2="129.6875"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="511" x2="511" y1="129.6875" y2="170.6426"/><line style="stroke:#222222;stroke-width:1.0;" x1="511" x2="511" y1="170.6426" y2="244.5742"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="511" x2="511" y1="244.5742" y2="285.5293"/><line style="stroke:#222222;stroke-width:1.0;" x1="511" x2="511" y1="285.5293" y2="1158.5957"/><line style="stroke:#222222;stroke-width:1.0;" x1="724" x2="724" y1="119.6875" y2="129.6875"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="724" x2="724" y1="129.6875" y2="170.6426"/><line style="stroke:#222222;stroke-width:1.0;" x1="724" x2="724" y1="170.6426" y2="244.5742"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="724" x2="724" y1="244.5742" y2="285.5293"/><line style="stroke:#222222;stroke-width:1.0;" x1="724" x2="724" y1="285.5293" y2="1158.5957"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="14" lengthAdjust="spacing" textLength="31" x="20" y="116.7344">User</text><ellipse cx="38.5" cy="50.1992" fill="#EEEEEE" rx="8" ry="8" style="stroke:#000000;stroke-width:2.0;"/><path d="M38.5,58.1992 L38.5,85.1992 M25.5,66.1992 L51.5,66.1992 M38.5,85.1992 L25.5,100.1992 M38.5,85.1992 L51.5,100.1992 " fill="none" style="stroke:#000000;stroke-width:2.0;"/><rect fill="#FFFFFF" height="34.0215" style="stroke:#111111;stroke-width:1.5;" width="87" x="182" y="84.666"/><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="73" x="189" y="108.1016">YourApp</text><rect fill="#FFFFFF" height="54.043" style="stroke:#111111;stroke-width:1.5;" width="65" x="479" y="64.6445"/><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="51" x="486" y="88.0801">Riiiver</text><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="33" x="495" y="108.1016">SDK</text><rect fill="#FFFFFF" height="54.043" style="stroke:#111111;stroke-width:1.5;" width="65" x="692" y="64.6445"/><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="51" x="699" y="88.0801">Riiiver</text><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="49" x="700" y="108.1016">Cloud</text><rect fill="#FFFFFF" height="114.8867" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="220.5" y="129.6875"/><line style="stroke:#222222;stroke-width:1.0;" x1="220.5" x2="220.5" y1="129.6875" y2="244.5742"/><line style="stroke:#222222;stroke-width:1.0;" x1="230.5" x2="230.5" y1="129.6875" y2="244.5742"/><line style="stroke:#222222;stroke-width:1.0;" x1="220.5" x2="230.5" y1="129.6875" y2="129.6875"/><rect fill="#FFFFFF" height="864.0664" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="220.5" y="285.5293"/><line style="stroke:#222222;stroke-width:1.0;" x1="220.5" x2="220.5" y1="285.5293" y2="1149.5957"/><line style="stroke:#222222;stroke-width:1.0;" x1="230.5" x2="230.5" y1="285.5293" y2="1149.5957"/><line style="stroke:#222222;stroke-width:1.0;" x1="220.5" x2="230.5" y1="1149.5957" y2="1149.5957"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="11" lengthAdjust="spacing" textLength="313" x="225" y="154.3223">ログイン済み ー iiideaは対象のERAppletクラスのインスタンス</text><polygon fill="#444444" points="208.5,203.2637,218.5,207.2637,208.5,211.2637,212.5,207.2637" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="38.5" x2="214.5" y1="207.2637" y2="207.2637"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="104" x="45.5" y="187.2109">PreferenceUIから</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="73" x="45.5" y="202.5215">iiideaに設定</text><polygon fill="#444444" points="499.5,232.5742,509.5,236.5742,499.5,240.5742,503.5,236.5742" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="230.5" x2="505.5" y1="236.5742" y2="236.5742"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="130" x="237.5" y="231.832">認証セッションを更新</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="11" lengthAdjust="spacing" textLength="143" x="310" y="269.209">「認証情報を更新する」参照</text><path d="M235,290.5293 L235,330.5293 L649,330.5293 L649,300.5293 L639,290.5293 L235,290.5293 " fill="#F9B5AD" style="stroke:#A80036;stroke-width:1.0;"/><path d="M639,290.5293 L639,300.5293 L649,300.5293 L639,290.5293 " fill="#F9B5AD" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="47" x="241" y="308.0977">iiideaの</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="273" x="288" y="308.0977">アクティベート前に必ずPreference設定が必要</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="39" x="561" y="308.0977">です。</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="393" x="241" y="323.4082">loadPreferences()を呼ぶとPreferenceを設定したことになります。</text><polygon fill="#444444" points="499.5,399.3926,509.5,403.3926,499.5,407.3926,503.5,403.3926" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="230.5" x2="505.5" y1="403.3926" y2="403.3926"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="103" x="237.5" y="352.7188">loadPreferences(</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="107" x="269.5" y="368.0293">applet: ERApplet,</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="116" x="269.5" y="383.3398">urlBaseFolder: URL</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="4" x="237.5" y="398.6504">)</text><polygon fill="#444444" points="241.5,428.7031,231.5,432.7031,241.5,436.7031,237.5,432.7031" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="235.5" x2="510.5" y1="432.7031" y2="432.7031"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="210" x="247.5" y="427.9609">webView内にPreference画面を表示</text><polygon fill="#444444" points="49.5,458.0137,39.5,462.0137,49.5,466.0137,45.5,462.0137" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="43.5" x2="219.5" y1="462.0137" y2="462.0137"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="91" x="55.5" y="457.2715">設定画面を表示</text><polygon fill="#444444" points="499.5,487.3242,509.5,491.3242,499.5,495.3242,503.5,491.3242" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="38.5" x2="505.5" y1="491.3242" y2="491.3242"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="130" x="45.5" y="486.582">Preference画面の操作</text><line style="stroke:#444444;stroke-width:1.0;" x1="511.5" x2="553.5" y1="520.6348" y2="520.6348"/><line style="stroke:#444444;stroke-width:1.0;" x1="553.5" x2="553.5" y1="520.6348" y2="533.6348"/><line style="stroke:#444444;stroke-width:1.0;" x1="512.5" x2="553.5" y1="533.6348" y2="533.6348"/><polygon fill="#444444" points="522.5,529.6348,512.5,533.6348,522.5,537.6348,518.5,533.6348" style="stroke:#444444;stroke-width:1.0;"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="117" x="518.5" y="515.8926">Preference値の設定</text><polygon fill="#444444" points="522.5,574.2559,512.5,578.2559,522.5,582.2559,518.5,578.2559" style="stroke:#444444;stroke-width:1.0;"/><polygon fill="#444444" points="712.5,574.2559,722.5,578.2559,712.5,582.2559,716.5,578.2559" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="516.5" x2="718.5" y1="578.2559" y2="578.2559"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="189" x="528.5" y="558.2031">iiideaがwebサービスとの認証が</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="117" x="528.5" y="573.5137">必要な時の処理など</text><polygon fill="#444444" points="49.5,603.5664,39.5,607.5664,49.5,611.5664,45.5,607.5664" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43.5" x2="510.5" y1="607.5664" y2="607.5664"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="156" x="55.5" y="602.8242">Preference画面に値を更新</text><polygon fill="#444444" points="208.5,648.1875,218.5,652.1875,208.5,656.1875,212.5,652.1875" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="38.5" x2="214.5" y1="652.1875" y2="652.1875"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="97" x="45.5" y="632.1348">iiideaをON(利用</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="95" x="45.5" y="647.4453">可能状態に)する</text><polygon fill="#444444" points="499.5,754.0508,509.5,758.0508,499.5,762.0508,503.5,758.0508" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="230.5" x2="505.5" y1="758.0508" y2="758.0508"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="91" x="237.5" y="676.7559">iiidea.activate(</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="71" x="269.5" y="692.0664">completion</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="193" x="301.5" y="707.377">&lt; unauthorizedPermissionList,</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="145" x="301.5" y="722.6875">unauthorizedProxyList,</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="48" x="301.5" y="737.998">error &gt;:</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="4" x="237.5" y="753.3086">)</text><polygon fill="#444444" points="522.5,798.6719,512.5,802.6719,522.5,806.6719,518.5,802.6719" style="stroke:#444444;stroke-width:1.0;"/><polygon fill="#444444" points="712.5,798.6719,722.5,802.6719,712.5,806.6719,716.5,802.6719" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="516.5" x2="718.5" y1="802.6719" y2="802.6719"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="189" x="528.5" y="782.6191">iiideaがwebサービスとの認証が</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="117" x="528.5" y="797.9297">必要な時の処理など</text><polygon fill="#444444" points="241.5,889.2246,231.5,893.2246,241.5,897.2246,237.5,893.2246" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="235.5" x2="510.5" y1="893.2246" y2="893.2246"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="75" x="247.5" y="827.2402">completion(</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="179" x="279.5" y="842.5508">unauthorizedPermissionList,</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="150" x="279.5" y="857.8613">tunauthorizedProxyList,</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="30" x="279.5" y="873.1719">error</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="4" x="247.5" y="888.4824">)</text><path d="M10,908.2246 L72,908.2246 L72,915.2246 L62,925.2246 L10,925.2246 L10,908.2246 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="233.3711" style="stroke:#000000;stroke-width:2.0;" width="684" x="10" y="908.2246"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="25" y="921.793">alt</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="510" x="87" y="920.8594">[completionのunauthorizedPermissionList / unauthorizedProxyList / errorが全てnil &lt;成功&gt;]</text><polygon fill="#444444" points="49.5,942.8457,39.5,946.8457,49.5,950.8457,45.5,946.8457" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43.5" x2="219.5" y1="946.8457" y2="946.8457"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="158" x="55.5" y="942.1035">iiideaをONしたことを通知</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="694" y1="955.8457" y2="955.8457"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="155" x="15" y="966.4805">[nil以外が戻ってくる &lt;失敗&gt;]</text><path d="M235,974.8008 L235,1106.8008 L684,1106.8008 L684,984.8008 L674,974.8008 L235,974.8008 " fill="#F9B5AD" style="stroke:#A80036;stroke-width:1.0;"/><path d="M674,974.8008 L674,984.8008 L684,984.8008 L674,974.8008 " fill="#F9B5AD" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="393" x="241" y="992.3691">外部のwebサービスを利用する場合や、OSに位置情報などの権限を</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="195" x="241" y="1007.6797">必要とする機能を利用する場合：</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="0" x="245" y="1022.9902"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="329" x="257" y="1038.3008">外部Webサービス利用に必要な認証情報が足りない場合:</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="362" x="273" y="1053.6113">unauthorizedProxyListとして必要な情報リストが渡される。</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="0" x="245" y="1068.9219"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="229" x="257" y="1084.2324">OSから必要な権限が取れていない場合:</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="396" x="273" y="1099.543">unauthorizedPermissionListとして必要な権限リストが渡される。</text><polygon fill="#444444" points="49.5,1129.5957,39.5,1133.5957,49.5,1137.5957,45.5,1133.5957" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="43.5" x2="219.5" y1="1133.5957" y2="1133.5957"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="104" x="55.5" y="1128.8535">必要な設定を促す</text><!--MD5=[e8bdf0602805cf487e6b5fd6cde393e6]
@startuml
title iiideaをON(アクティベート)する
hide footbox

skinparam DefaultFontName "Noto Sans JP, Helvetica, Arial, Liberation Sans"
skinparam BackgroundColor #F2EEE6
skinparam Shadowing false
skinparam NoteBackgroundColor #F9B5AD
skinparam NodeBorderColor #F26767

skinparam sequence {
ArrowColor #444444
ActorBorderColor Black
LifeLineBorderColor #222222
LifeLineBackgroundColor White
BoxBorderColor #FFFFFF
BoxBackgroundColor #F2fEf6
GroupBackgroundColor #FFFFFF
GroupBodyBackgroundColor #F3F0F0

ParticipantBorderColor #111111
ParticipantBackgroundColor White
ParticipantFontSize 17
ParticipantFontColor #111111
BoundaryBorderColor Gray
ActorBackgroundColor #eeeeee
ActorFontColor Black

}

actor User
participant YourApp as App
participant "Riiiver\nSDK" as ERSDK
participant "Riiiver\nCloud" as Riiiver

activate App

... ログイン済み ー iiideaは対象のERAppletクラスのインスタンス ...

User -> App: PreferenceUIから\niiideaに設定

App -> ERSDK: 認証セッションを更新
... 「認証情報を更新する」参照 ...
note right of App: iiideaの__アクティベート前に必ずPreference設定が必要__です。\nloadPreferences()を呼ぶとPreferenceを設定したことになります。
App -> ERSDK: loadPreferences(\n\tapplet: ERApplet,\n\turlBaseFolder: URL\n)
App <- - ERSDK: webView内にPreference画面を表示
User <- App: 設定画面を表示
User - -> ERSDK: Preference画面の操作
ERSDK -> ERSDK: Preference値の設定
ERSDK <- -> Riiiver: iiideaがwebサービスとの認証が\n必要な時の処理など
User <- - ERSDK: Preference画面に値を更新

User -> App: iiideaをON(利用\n可能状態に)する
App -> ERSDK: iiidea.activate(\n\tcompletion\n\t\t< unauthorizedPermissionList,\n\t\tunauthorizedProxyList,\n\t\terror >:\n)
ERSDK <- -> Riiiver: iiideaがwebサービスとの認証が\n必要な時の処理など
App <- - ERSDK: completion(\n\tunauthorizedPermissionList,\n\ttunauthorizedProxyList,\n\terror\n)
alt completionのunauthorizedPermissionList / unauthorizedProxyList / errorが全てnil <成功>
    User <- - App: iiideaをONしたことを通知
else nil以外が戻ってくる <失敗>
    note right of App
        外部のwebサービスを利用する場合や、OSに位置情報などの権限を
        必要とする機能を利用する場合：

            外部Webサービス利用に必要な認証情報が足りない場合:
                unauthorizedProxyListとして必要な情報リストが渡される。

            OSから必要な権限が取れていない場合:
                unauthorizedPermissionListとして必要な権限リストが渡される。
    end note
    App -> User: 必要な設定を促す
end

@enduml

PlantUML version 1.2021.2(Sun Mar 07 20:10:27 JST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: ja
Country: JP
--></g></svg>