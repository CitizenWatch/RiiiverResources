<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="701px" preserveAspectRatio="none" style="width:770px;height:701px;background:#F2EEE6;" version="1.1" viewBox="0 0 770 701" width="770px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="18" lengthAdjust="spacing" textLength="162" x="305.75" y="29.4023">認証情報を更新する</text><rect fill="#FFFFFF" height="413.5684" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="218.5" y="129.6875"/><line style="stroke:#222222;stroke-width:1.0;" x1="218.5" x2="218.5" y1="129.6875" y2="543.2559"/><line style="stroke:#222222;stroke-width:1.0;" x1="228.5" x2="228.5" y1="129.6875" y2="543.2559"/><line style="stroke:#222222;stroke-width:1.0;" x1="218.5" x2="228.5" y1="129.6875" y2="129.6875"/><rect fill="#FFFFFF" height="101.5762" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="218.5" y="584.2109"/><line style="stroke:#222222;stroke-width:1.0;" x1="218.5" x2="218.5" y1="584.2109" y2="685.7871"/><line style="stroke:#222222;stroke-width:1.0;" x1="228.5" x2="228.5" y1="584.2109" y2="685.7871"/><line style="stroke:#222222;stroke-width:1.0;" x1="218.5" x2="228.5" y1="685.7871" y2="685.7871"/><rect fill="#F3F0F0" height="457.834" style="stroke:#000000;stroke-width:2.0;" width="753.5" x="10" y="219.9531"/><rect fill="#F3F0F0" height="176.7734" style="stroke:#000000;stroke-width:2.0;" width="583.5" x="170" y="407.4375"/><rect fill="#F3F0F0" height="55.9102" style="stroke:none;stroke-width:1.0;" width="583.5" x="170" y="528.3008"/><rect fill="#F3F0F0" height="86.5762" style="stroke:none;stroke-width:1.0;" width="753.5" x="10" y="591.2109"/><line style="stroke:#222222;stroke-width:1.0;" x1="38" x2="38" y1="119.6875" y2="129.6875"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="38" x2="38" y1="129.6875" y2="170.6426"/><line style="stroke:#222222;stroke-width:1.0;" x1="38" x2="38" y1="170.6426" y2="543.2559"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="38" x2="38" y1="543.2559" y2="584.2109"/><line style="stroke:#222222;stroke-width:1.0;" x1="38" x2="38" y1="584.2109" y2="694.7871"/><line style="stroke:#222222;stroke-width:1.0;" x1="223" x2="223" y1="119.6875" y2="129.6875"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="223" x2="223" y1="129.6875" y2="170.6426"/><line style="stroke:#222222;stroke-width:1.0;" x1="223" x2="223" y1="170.6426" y2="543.2559"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="223" x2="223" y1="543.2559" y2="584.2109"/><line style="stroke:#222222;stroke-width:1.0;" x1="223" x2="223" y1="584.2109" y2="694.7871"/><line style="stroke:#222222;stroke-width:1.0;" x1="505" x2="505" y1="119.6875" y2="129.6875"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="505" x2="505" y1="129.6875" y2="170.6426"/><line style="stroke:#222222;stroke-width:1.0;" x1="505" x2="505" y1="170.6426" y2="543.2559"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="505" x2="505" y1="543.2559" y2="584.2109"/><line style="stroke:#222222;stroke-width:1.0;" x1="505" x2="505" y1="584.2109" y2="694.7871"/><line style="stroke:#222222;stroke-width:1.0;" x1="607" x2="607" y1="119.6875" y2="129.6875"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="607" x2="607" y1="129.6875" y2="170.6426"/><line style="stroke:#222222;stroke-width:1.0;" x1="607" x2="607" y1="170.6426" y2="543.2559"/><line style="stroke:#222222;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="607" x2="607" y1="543.2559" y2="584.2109"/><line style="stroke:#222222;stroke-width:1.0;" x1="607" x2="607" y1="584.2109" y2="694.7871"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="14" lengthAdjust="spacing" textLength="31" x="20" y="116.7344">User</text><ellipse cx="38.5" cy="50.1992" fill="#EEEEEE" rx="8" ry="8" style="stroke:#000000;stroke-width:2.0;"/><path d="M38.5,58.1992 L38.5,85.1992 M25.5,66.1992 L51.5,66.1992 M38.5,85.1992 L25.5,100.1992 M38.5,85.1992 L51.5,100.1992 " fill="none" style="stroke:#000000;stroke-width:2.0;"/><rect fill="#FFFFFF" height="34.0215" style="stroke:#111111;stroke-width:1.5;" width="87" x="180" y="84.666"/><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="73" x="187" y="108.1016">YourApp</text><rect fill="#FFFFFF" height="54.043" style="stroke:#111111;stroke-width:1.5;" width="65" x="473" y="64.6445"/><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="51" x="480" y="88.0801">Riiiver</text><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="33" x="489" y="108.1016">SDK</text><rect fill="#FFFFFF" height="54.043" style="stroke:#111111;stroke-width:1.5;" width="65" x="575" y="64.6445"/><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="51" x="582" y="88.0801">Riiiver</text><text fill="#111111" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="17" lengthAdjust="spacing" textLength="49" x="583" y="108.1016">Cloud</text><rect fill="#FFFFFF" height="413.5684" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="218.5" y="129.6875"/><line style="stroke:#222222;stroke-width:1.0;" x1="218.5" x2="218.5" y1="129.6875" y2="543.2559"/><line style="stroke:#222222;stroke-width:1.0;" x1="228.5" x2="228.5" y1="129.6875" y2="543.2559"/><line style="stroke:#222222;stroke-width:1.0;" x1="218.5" x2="228.5" y1="129.6875" y2="129.6875"/><rect fill="#FFFFFF" height="101.5762" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="218.5" y="584.2109"/><line style="stroke:#222222;stroke-width:1.0;" x1="218.5" x2="218.5" y1="584.2109" y2="685.7871"/><line style="stroke:#222222;stroke-width:1.0;" x1="228.5" x2="228.5" y1="584.2109" y2="685.7871"/><line style="stroke:#222222;stroke-width:1.0;" x1="218.5" x2="228.5" y1="685.7871" y2="685.7871"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="11" lengthAdjust="spacing" textLength="313" x="166.5" y="154.3223">ログイン済み ー iiideaは対象のERAppletクラスのインスタンス</text><line style="stroke:#444444;stroke-width:1.0;" x1="228.5" x2="270.5" y1="191.9531" y2="191.9531"/><line style="stroke:#444444;stroke-width:1.0;" x1="270.5" x2="270.5" y1="191.9531" y2="204.9531"/><line style="stroke:#444444;stroke-width:1.0;" x1="229.5" x2="270.5" y1="204.9531" y2="204.9531"/><polygon fill="#444444" points="239.5,200.9531,229.5,204.9531,239.5,208.9531,235.5,204.9531" style="stroke:#444444;stroke-width:1.0;"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="143" x="235.5" y="187.2109">ネットワーク状態の確認</text><path d="M10,219.9531 L72,219.9531 L72,226.9531 L62,236.9531 L10,236.9531 L10,219.9531 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="457.834" style="stroke:#000000;stroke-width:2.0;" width="753.5" x="10" y="219.9531"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="25" y="233.5215">alt</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140" x="87" y="232.5879">[ネットワークあり（圏内）]</text><polygon fill="#444444" points="493.5,300.5059,503.5,304.5059,493.5,308.5059,497.5,304.5059" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="228.5" x2="499.5" y1="304.5059" y2="304.5059"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="130" x="235.5" y="253.832">認証セッションを更新</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="211" x="235.5" y="269.1426">ERAuth.sharedInstance.getToken(</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="120" x="267.5" y="284.4531">completionHandler</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="4" x="235.5" y="299.7637">)</text><polygon fill="#444444" points="595.5,329.8164,605.5,333.8164,595.5,337.8164,599.5,333.8164" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="505.5" x2="601.5" y1="333.8164" y2="333.8164"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="78" x="512.5" y="329.0742">ログイン処理</text><polygon fill="#444444" points="516.5,359.127,506.5,363.127,516.5,367.127,512.5,363.127" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="510.5" x2="606.5" y1="363.127" y2="363.127"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="39" x="522.5" y="358.3848">Token</text><polygon fill="#444444" points="239.5,388.4375,229.5,392.4375,239.5,396.4375,235.5,392.4375" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="233.5" x2="504.5" y1="392.4375" y2="392.4375"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="210" x="245.5" y="387.6953">completionHandler( error, token )</text><path d="M170,407.4375 L232,407.4375 L232,414.4375 L222,424.4375 L170,424.4375 L170,407.4375 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="176.7734" style="stroke:#000000;stroke-width:2.0;" width="583.5" x="170" y="407.4375"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="185" y="421.0059">alt</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="221" x="247" y="420.0723">[token != nil(null) &amp;&amp; error != nil(null)]</text><line style="stroke:#444444;stroke-width:1.0;" x1="228.5" x2="270.5" y1="507.3008" y2="507.3008"/><line style="stroke:#444444;stroke-width:1.0;" x1="270.5" x2="270.5" y1="507.3008" y2="520.3008"/><line style="stroke:#444444;stroke-width:1.0;" x1="229.5" x2="270.5" y1="520.3008" y2="520.3008"/><polygon fill="#444444" points="239.5,516.3008,229.5,520.3008,239.5,524.3008,235.5,520.3008" style="stroke:#444444;stroke-width:1.0;"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="75" x="235.5" y="441.3164">tokenを保存</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="4" x="235.5" y="456.627">(</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="254" x="239.5" y="471.9375">local.accessToken = token.accessToken</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="154" x="239.5" y="487.248">local.idToken = idToken</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="4" x="235.5" y="502.5586">)</text><path d="M505,463.8691 L505,488.8691 L733,488.8691 L733,473.8691 L723,463.8691 L505,463.8691 " fill="#F9B5AD" style="stroke:#A80036;stroke-width:1.0;"/><path d="M723,463.8691 L723,473.8691 L733,473.8691 L723,463.8691 " fill="#F9B5AD" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="207" x="511" y="481.4375">RiiiverSDKから認証情報の取得成功</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="170" x2="753.5" y1="529.3008" y2="529.3008"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="30" x="175" y="539.9355">[else]</text><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="11" lengthAdjust="spacing" textLength="132" x="257" y="567.8906">ログイン処理からやり直し</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="763.5" y1="592.2109" y2="592.2109"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140" x="15" y="602.8457">[ネットワークなし（圏外）]</text><line style="stroke:#444444;stroke-width:1.0;" x1="228.5" x2="270.5" y1="627.4766" y2="627.4766"/><line style="stroke:#444444;stroke-width:1.0;" x1="270.5" x2="270.5" y1="627.4766" y2="640.4766"/><line style="stroke:#444444;stroke-width:1.0;" x1="229.5" x2="270.5" y1="640.4766" y2="640.4766"/><polygon fill="#444444" points="239.5,636.4766,229.5,640.4766,239.5,644.4766,235.5,640.4766" style="stroke:#444444;stroke-width:1.0;"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="143" x="235.5" y="622.7344">ネットワークエラー処理</text><polygon fill="#444444" points="49.5,665.7871,39.5,669.7871,49.5,673.7871,45.5,669.7871" style="stroke:#444444;stroke-width:1.0;"/><line style="stroke:#444444;stroke-width:1.0;" x1="43.5" x2="217.5" y1="669.7871" y2="669.7871"/><text fill="#000000" font-family="Noto Sans JP, Helvetica, Arial, Liberation Sans" font-size="13" lengthAdjust="spacing" textLength="156" x="55.5" y="665.0449">「ネットワークエラー」　</text><!--MD5=[991cf1043fd5c7a2b556da560d535b0e]
@startuml
title 認証情報を更新する
hide footbox

skinparam DefaultFontName "Noto Sans JP, Helvetica, Arial, Liberation Sans"
skinparam BackgroundColor #F2EEE6
skinparam Shadowing false
skinparam NoteBackgroundColor #F9B5AD
skinparam NodeBorderColor #F26767

skinparam sequence {
ArrowColor #444444
ActorBorderColor Black
LifeLineBorderColor #222222
LifeLineBackgroundColor White
BoxBorderColor #FFFFFF
BoxBackgroundColor #F2fEf6
GroupBackgroundColor #FFFFFF
GroupBodyBackgroundColor #F3F0F0

ParticipantBorderColor #111111
ParticipantBackgroundColor White
ParticipantFontSize 17
ParticipantFontColor #111111
BoundaryBorderColor Gray
ActorBackgroundColor #eeeeee
ActorFontColor Black

}

actor User
participant YourApp as App
participant "Riiiver\nSDK" as ERSDK
participant "Riiiver\nCloud" as Riiiver

activate App

... ログイン済み ー iiideaは対象のERAppletクラスのインスタンス ...

App -> App: ネットワーク状態の確認
alt ネットワークあり（圏内）
    App -> ERSDK: 認証セッションを更新\nERAuth.sharedInstance.getToken(\n\tcompletionHandler\n)
    ERSDK -> Riiiver: ログイン処理
    ERSDK <- - Riiiver: Token
    App <- - ERSDK: completionHandler( error, token )
    alt token != nil(null) && error != nil(null)
        App -> App: tokenを保存\n(\n local.accessToken = token.accessToken\n local.idToken = idToken\n)
        note right: RiiiverSDKから認証情報の取得成功
    else else
        ... ログイン処理からやり直し ...
    end
else ネットワークなし（圏外）
    App -> App: ネットワークエラー処理
    User <- App: 「ネットワークエラー」　
end

@enduml

PlantUML version 1.2021.2(Sun Mar 07 20:10:27 JST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: ja
Country: JP
--></g></svg>